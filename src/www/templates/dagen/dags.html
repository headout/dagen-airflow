{% extends base_template %}
{% block page_title %}Dagen-managed DAGS
{% endblock
%}
{% block head_css %}
    {{ super() }}
    <style>
  span.highlighted {
    background: #f1c40f;
    display: inline-block;
    font-weight: bold;
    padding: 0 6px;
  }
</style>
{% endblock %}
{% block content %}
    <h2>Dagen-managed DAGS</h2>
    <hr/>

    <ul class="nav nav-tabs actions-nav">
        <li class="active">
            <a href="{{ url_for('DagenFABView.list') }}">List ({{ dbDags|length }})</a>
        </li>
        {% if perm_can_create %}
            <li>
                <a href="{{ url_for('DagenFABView.create') }}" title="Create New DAG">Create</a>
            </li>
        {% endif %}
    </ul>

    <div class="clearfix"></div>
    <table class="table table-striped table-bordered table-hover model-list">
        <thead>
            <tr role="row">
                <th width="12">
                    <span class="glyphicon glyphicon-info-sign" data-original-title="Toggle live status of DAG" id="state_header" title=""></span>
                </th>
                <th class="column-header">
                    Dag Representation
                </th>
                <th class="column-header">
                    Scheduled Interval
                </th>
                <th class="column-header">
                    Author
                </th>
                <th class="col-md-1">
                    Links
                </th>
            </tr>
        </thead>
        {% for dbDag in dbDags %}
            <tr>
                <td>
                    {% if dbDag.is_enabled %}
                        <span class="label" data-original-title="Published" style="background-color: green;" title="">{{ dbDag.version_str }}</span>
                    {% elif dbDag.is_published %}
                        <span class="label" data-original-title="Pending Approval" style="background-color: yellow; color: black;" title="">{{ dbDag.version_str }}</span>
                    {% else %}
                        <span class="label" data-original-title="Disabled" style="background-color: red;" title="">X</span>
                    {% endif %}
                </td>
                <td>
                    <span class="label label-default">{{ dbDag }}</span>
                </td>
                <td>
                    <span class="label label-default">
                        {% if dbDag.is_published %}
                            {{ dbDag.live_version.schedule_interval }}
                            {%
        else %}-
                        {% endif %}
                    </span>
                </td>
                <td>
                    <span class="label label-default">
                        {% if dbDag.is_published %}
                            {{ dbDag.live_version.creator_str }}
                            {% else %}-
                        {% endif %}
                    </span>
                </td>
                <td class="list-buttons-column">
                    {% if perm_can_edit %}
                        <a class="icon link-tooltip" href="{{ url_for('DagenFABView.edit', dag_id=dbDag.dag_id) }}" title="Edit">
                            <span class="fa fa-pencil glyphicon glyphicon-pencil" data-original-title="" title=""></span>
                        </a>
                    {% endif %}
                    {% if dbDag.is_published and perm_can_detail %}
                        <a class="icon link-tooltip" href="{{ url_for('DagenFABView.detail', dag_id=dbDag.dag_id) }}" title="Details">
                            <span class="fa fa-pencil glyphicon glyphicon-list" data-original-title="" title=""></span>
                        </a>
                    {% endif %}
                    {% if dbDag.is_published and not dbDag.is_enabled and perm_can_approve %}
                        <a class="icon link-tooltip" href="{{ url_for('DagenFABView.approve', dag_id=dbDag.dag_id) }}" title="Approve">
                            <span class="fa fa-pencil glyphicon glyphicon-plane" data-original-title="" title=""></span>
                        </a>
                    {% endif %}
                    {% if perm_can_delete %}
                        <a class="icon link-tooltip" href="{{ url_for('DagenFABView.delete', dag_id=dbDag.dag_id) }}">
                            <span class="glyphicon glyphicon-remove-circle" data-original-title="Delete" style="color: red;"></span>
                        </a>
                    {% endif %}
                </td>
            </tr>
        {% endfor %}
    </table>
{% endblock %}
